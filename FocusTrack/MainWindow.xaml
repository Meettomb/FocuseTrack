<Window x:Class="FocusTrack.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:lvc="clr-namespace:LiveChartsCore.SkiaSharpView.WPF;assembly=LiveChartsCore.SkiaSharpView.WPF"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        xmlns:controls="clr-namespace:FocusTrack.Controls"
        mc:Ignorable="d"
        WindowStyle="None"
        ResizeMode="NoResize"
        AllowsTransparency="False"
        Background="#10131C"
        Title="Focus Track"
        Height="450"
        Width="800"
        Icon="/Images/AppLogo/FocusTrack.ico">

    <Grid>
        <Grid.RowDefinitions>
            <!-- Header row -->
            <RowDefinition Height="Auto"/>

            <!-- Main content row -->
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header (fixed, not scrollable) -->
        <Border Background="#222" Grid.Row="0" Height="auto" VerticalAlignment="Top">
            <Grid>
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="10 0 0 0">
                    <Image Source="/Images/AppLogo/FocusTrack.png" Width="35" Height="Auto"/>
                    <TextBlock Text="Focus Track"
                               VerticalAlignment="Center"
                               Margin="10,0,0,0"
                               Foreground="White"
                               FontSize="22"
                               FontWeight="Bold"/>
                </StackPanel>

                <!-- Close/Minimize Buttons -->
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center">
                    <Button Click="Minimize_Click" Style="{StaticResource HeaderMinimizeStyle}"/>
                    <Button Style="{StaticResource HeaderMaximizeStyle}" Click="Maximize_Click"/>
                    <Button Click="Close_Click" Style="{StaticResource HeaderCloseButton}"/>
                </StackPanel>
            </Grid>
        </Border>

        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="60"/>
                <!-- Sidebar width -->
                <ColumnDefinition Width="*"/>
                <!-- Main Content -->
            </Grid.ColumnDefinitions>

            <Grid Background="#222">
                <Grid.RowDefinitions> 
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <StackPanel Grid.Row="0"  Grid.Column="0" VerticalAlignment="Stretch">

                    <Button Style="{StaticResource NavButton1}" Click="HomeButton_Click"/>
                    <Button Style="{StaticResource NavButton2}" Click="AppOpenTimeButton_Click"/>


                </StackPanel>

                <StackPanel Grid.Row="2" Background="#222" Grid.Column="0" VerticalAlignment="Stretch">

                    <Button Style="{StaticResource NavButton3}" Click="SettingButton_Click"/>

                </StackPanel>
            </Grid>

            <!-- Main Content with Scroll -->
            <ScrollViewer Grid.Column="1" VerticalScrollBarVisibility="Hidden"
                        CanContentScroll="False"
                        PanningMode="VerticalFirst">
            <Grid Margin="0,20,0,0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Dropdown -->
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="10 0 10 10" Grid.Row="0">
                    <ComboBox x:Name="RangeSelecter"
                              SelectionChanged="RangeSelectot_SelectionChanged"
                              Width="120">
                        <ComboBoxItem Content="Default" Tag="today" IsSelected="True"/>
                        <ComboBoxItem Content="Last 7 Days" Tag="7d"/>
                        <ComboBoxItem Content="Last 1 Month" Tag="1m"/>
                        <ComboBoxItem Content="Last 3 Months" Tag="3m"/>
                        <ComboBoxItem Content="Over All" Tag="overall"/>
                    </ComboBox>
                </StackPanel>

                <!-- Chart -->
                <Grid Grid.Row="1" Margin="10 5 10 10" Height="400" VerticalAlignment="Top">
                    <lvc:CartesianChart x:Name="UsageChart"/>
                </Grid>

                <!-- Date Select-->
                <Grid Grid.Row="2" Margin="0,20,0,20" HorizontalAlignment="Center">
                    <!-- Define two columns: auto width for button, remaining space for TextBlock -->
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- Previous Day Button -->
                    <Button Style="{StaticResource PrevDayButton}" Grid.Column="0"
                        Click="PrevDayButton_Click">
                    </Button>

                    <!-- Date TextBlock -->
                    <TextBlock Grid.Column="1"
                           Name="DateTextBlock"
                           Style="{StaticResource DateSelect}"
                           Text="{Binding SelectedDate, StringFormat=d-MMMM-yyyy}"
                           VerticalAlignment="Center"
                           Padding="5"
                           MouseLeftButtonUp="DateTextBlock_MouseLeftButtonUp"
                           Cursor="Hand"/>  

                    <!-- Hidden DatePicker -->
                   


                    <!-- Next Day Button -->
                    <Button Style="{StaticResource NextDayButton}" Grid.Column="2"
                        Click="NextDayButton_Click">
                    </Button>

                </Grid>

                <!-- DataGrid -->
                <Grid Grid.Row="3" Margin="10 20 10 20">
                    <DataGrid x:Name="AppUsageGrid"
                      Style="{StaticResource AppUsageGridStyle}"
                      ColumnHeaderStyle="{StaticResource AppUsageGridColumnHeaderStyle}"
                      AutoGenerateColumns="False"
                      MaxHeight="300"
                      HorizontalAlignment="Stretch"
                      ScrollViewer.VerticalScrollBarVisibility="Hidden"
                      ScrollViewer.HorizontalScrollBarVisibility="Hidden"
                      CanUserAddRows="False"
                      IsReadOnly="True">

                        <DataGrid.Columns>
                            <!-- Icon: fixed left width -->
                            <DataGridTemplateColumn Header="Icon" Width="60">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Image Width="35" Height="35"
                                                Source="{Binding AppIcon, Converter={StaticResource ByteToImageConverter}}"
                                                VerticalAlignment="Center"
                                                HorizontalAlignment="Center"
                                                Margin="20 0 0 0"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>

                            <!-- Application: fill center -->
                            <DataGridTextColumn Header="Application" Binding="{Binding AppName}" Width="*" FontSize="16">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                        <Setter Property="Margin" Value="30 0 0 0"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>

                            <!-- Usage Time: fixed right width -->
                            <DataGridTextColumn Header="Usage Time" Binding="{Binding Duration}" Width="150">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                        <Setter Property="Margin" Value="0 0 20 0"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>


            </Grid>
        </ScrollViewer>


        </Grid>
        <Popup x:Name="CalendarPopup"
            Placement="Center"
            StaysOpen="False"
            AllowsTransparency="True"
            PopupAnimation="Fade"
            IsOpen="{Binding IsCalendarOpen}">
            <Border Background="#222" CornerRadius="8" Padding="10">
                <controls:CustomCalendar x:Name="CustomCalendarName" SelectedDate="{Binding SelectedDate, Mode=TwoWay}" />
            </Border>
        </Popup>

    </Grid>
</Window>
